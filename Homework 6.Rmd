---
title: "Homework 6"
author: "Jeanette Shekelle"
date: "11/27/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
```


### Problem 1


#### Reading in the data:

```{r}
homicide_data = read_csv(file = "./data/homicide_data.csv")
```


Cleaning the data:

```{r}
homicide_data_clean = 
  homicide_data %>% 
  janitor::clean_names() %>% 
   mutate(city_state = paste(city, state, sep = ','),
         solved = as.numeric(disposition == "Closed by arrest"), 
         victim_race = ifelse(victim_race != "White", "Non-White", "White"), 
         victim_race = fct_relevel(victim_race, "White", "non-White"),
         victim_age = as.numeric(victim_age)) %>% 
   filter(city_state != "Dallas, TX" | city_state != "Phoenix, AZ" | 
         city_state != "Kansas City, MO" | city_state != "Tulsa, AL")
  
```



Fitting logistic regression using glm:

```{r}

fit_logistic = 
  homicide_data_clean %>% 
  filter(city_state == "Baltimore, MD") %>% 
  glm(solved ~ victim_age + victim_race + victim_sex, 
      data = ., family = binomial()) fit_logistic %>% 
  broom::tidy() %>% 
  mutate(OR = exp(estimate), 
         lower_limit = exp(estimate - 1.96*std.error), 
         upper_limit = exp(estimate + 1.96*std.error)) %>%
  select(term, OR, lower_limit, upper_limit) %>% 
  filter(term == "victim_race = Non-White") %>% 
  knitr::kable(digits = 4)
```
